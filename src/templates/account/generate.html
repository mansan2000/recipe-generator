{% extends "base.html" %}

{% block content %}

<style>
  body {
    background-image: url("../../static/slider-image2.jpg");
    background-size: cover;
    background-repeat: no-repeat;
    background-attachment: fixed;
  }

  h2 {
    color: white;
  }
  label {
    color: white;
  }
  p {
    color: white;
  }
</style>


<div class="container mt-3">
  <ul class="nav nav-tabs">
    <li class="nav-item">
      <a class="nav-link active" href="/generate-recipes">Generate Recipes</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="/view-recipes">View Your Recipes</a>
    </li>
    <li class="nav-item ml-auto">
      <a class="nav-link" href="/logout">Logout</a>
    </li>

  </ul>
</div>


<!-- Section: Design Block -->
<div class="text-center text-lg-start">
  <style>
    .cascading-right {
      margin-right: -50px;
    }

    @media (max-width: 991.98px) {
      .cascading-right {
        margin-right: 0;
      }
    }
  </style>

  <div class="container py-4">
    <div class="row g-0 align-items-center">
      <!--      <div class="col-lg-6 mb-5 mb-lg-0">-->
      <!--        <div class="card cascading-right" style="-->
      <!--              background: hsla(0, 0%, 100%, 0.55);-->
      <!--              backdrop-filter: blur(30px);-->
      <!--              ">-->
      <!--          <div class="card-body p-5 shadow-5 text-center">-->
      <!--&lt;!&ndash;            <h2 class="fw-bold mb-5">Log in to Your Account</h2>&ndash;&gt;-->
      <!--&lt;!&ndash;            <form method="POST" action="/check-credentials">&ndash;&gt;-->


      <!--&lt;!&ndash;              &lt;!&ndash; Username input &ndash;&gt;&ndash;&gt;-->
      <!--&lt;!&ndash;              <div class="form-outline mb-4">&ndash;&gt;-->
      <!--&lt;!&ndash;                <input type="text" id="username" name="username" class="form-control" />&ndash;&gt;-->
      <!--&lt;!&ndash;                <label class="form-label" for="username">Username</label>&ndash;&gt;-->
      <!--&lt;!&ndash;              </div>&ndash;&gt;-->

      <!--&lt;!&ndash;              &lt;!&ndash; Password input &ndash;&gt;&ndash;&gt;-->
      <!--&lt;!&ndash;              <div class="form-outline mb-4">&ndash;&gt;-->
      <!--&lt;!&ndash;                <input type="password" id="password" name="password" class="form-control" />&ndash;&gt;-->
      <!--&lt;!&ndash;                <label class="form-label" for="password">Password</label>&ndash;&gt;-->
      <!--&lt;!&ndash;              </div>&ndash;&gt;-->



      <!--&lt;!&ndash;              &lt;!&ndash; Submit button &ndash;&gt;&ndash;&gt;-->
      <!--&lt;!&ndash;              <button type="submit" class="btn btn-primary btn-block mb-4">&ndash;&gt;-->
      <!--&lt;!&ndash;                Log In&ndash;&gt;-->
      <!--&lt;!&ndash;              </button>&ndash;&gt;-->

      <!--&lt;!&ndash;              <p class="text-center text-muted mt-5 mb-0">Don't have an account?<a href="signup"&ndash;&gt;-->
      <!--&lt;!&ndash;                  class="fw-bold text-body"><u>Register Today!</u></a></p>&ndash;&gt;-->
      <!--&lt;!&ndash;              <p style="color: red">{{incorrect}}</p>&ndash;&gt;-->




      <!--&lt;!&ndash;            </form>&ndash;&gt;-->
      <!--          </div>-->
      <!--        </div>-->
    </div>

    <h2 class="fw-bold mb-3">Generate Recipes</h2>

    <!-- Text boxes for recipe inputs -->
    <div id="wantRecipeBox">
      <input type="text" id="wantedRecipe" class="form-control mb-3" placeholder="Wanted Recipe (e.g., cake)">
      <input type="text" id="ranOutRecipe" class="form-control mb-3" placeholder="Missing Ingredients (e.g., eggs)">
    </div>

    <div id="haveRecipeBox" style="display: none;">
      <input type="text" id="haveRecipe" class="form-control mb-3" placeholder="Ingredients you have (e.g., flour, sugar, etc.)">
    </div>

    <!-- Toggle button to switch between recipeSelectionwant and recipeSelectionhave -->
    <div class="form-check form-switch mb-3">
      <input class="form-check-input" type="checkbox" id="toggleSelection">
      <label class="form-check-label" for="toggleSelection">Wanted to make... / I have...</label>
    </div>

    <!-- Submit button for recipeSelectionwant -->
    <button class="btn btn-primary mb-3" onclick="submitRecipe('want')" id="submitBtnWant">Submit</button>
    <!-- Submit button for recipeSelectionhave (initially hidden) -->
    <button class="btn btn-primary mb-3" onclick="submitRecipe('have')" id="submitBtnHave" style="display: none;">Submit</button>

    <div style="display: none;" id="loadingDiv">
      <p>Loading...</p>
      <div style="width:100%;height:0;padding-bottom:100%;position:relative;">
        <!-- https://giphy.com/stickers/bowl-mix-bake-US7pjGYkp8Qjjf3A8h -->
        <img src="../../static/whisking.gif" alt="Whisking" style="width: 100%; height: 100%; position: absolute;" />
      </div>
    </div>
  </div>
</div>>

<script>

  function submitRecipe() {
    // Hide the appropriate submit button and show the loading GIF and text
    document.getElementById('submitBtnWant').style.display = 'none';
    document.getElementById('submitBtnHave').style.display = 'none';
    document.getElementById('loadingDiv').style.display = 'block';

    const wanted = document.getElementById('wantedRecipe').value;
    const ranOut = document.getElementById('ranOutRecipe').value;
    const have = document.getElementById('haveRecipe').value;

    // Toggle between recipeSelectionwant and recipeSelectionhave based on the toggle state
    let url;
    let data;
    if (document.getElementById('toggleSelection').checked) {
      // If the toggle is checked, call recipeSelectionhave
      url = '/generate-recipes-have';
      data = { have };
    } else {
      // If the toggle is unchecked, call recipeSelectionwant
      url = '/generate-recipes-want';
      data = { wanted, ranOut };
    }

    // Make a POST request to the server with the data
    fetch(url, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify(data),
    })
            .then((response) => response.json())
            .then((data) => {
              // Redirect to the results page after generating the recipe
              window.location.href = '/results';
            })
            .catch((error) => console.error('Error:', error));
  }


  // Toggle the submit button based on the selection type
  document.getElementById('toggleSelection').addEventListener('change', function() {
    const wantRecipeBox = document.getElementById('wantRecipeBox');
    const haveRecipeBox = document.getElementById('haveRecipeBox');

    if (this.checked) {
      // If "Use Recipe Selection Have" is checked, show the submit button for recipeSelectionhave
      document.getElementById('submitBtnWant').style.display = 'none';
      document.getElementById('submitBtnHave').style.display = 'block';

      // Hide recipeSelectionwant inputs, show recipeSelectionhave inputs
      wantRecipeBox.style.display = 'none';
      haveRecipeBox.style.display = 'block';
    } else {
      // If "Use Recipe Selection Have" is unchecked, show the submit button for recipeSelectionwant
      document.getElementById('submitBtnWant').style.display = 'block';
      document.getElementById('submitBtnHave').style.display = 'none';

      // Show recipeSelectionwant inputs, hide recipeSelectionhave inputs
      wantRecipeBox.style.display = 'block';
      haveRecipeBox.style.display = 'none';
    }
  });

</script>

</body>

</html>

{% endblock %}